<h2>Findings</h2>
<form class="row g-2 mb-2" method="get">
  <div class="col-auto"><input class="form-control" name="scan_id" value="<%= params[:scan_id] %>" placeholder="scan_id"></div>
  <div class="col-auto">
    <select class="form-select" name="severity">
      <option value="">(severity)</option>
      <% %w[CRITICAL HIGH MEDIUM LOW].each do |s| %>
        <option value="<%= s %>" <%= 'selected' if params[:severity] == s %>><%= s %></option>
      <% end %>
    </select>
  </div>
  <div class="col-auto"><input class="form-control" name="q" value="<%= params[:q] %>" placeholder="file_path contains"></div>
  <div class="col-auto"><button class="btn btn-primary">Filter</button></div>
</form>

<table class="table table-striped table-sm">
  <thead><tr><th>ID</th><th>Scan</th><th>Rule</th><th>Severity</th><th>File</th></tr></thead>
  <tbody>
    <% @findings.each do |f| %>
      <tr>
        <td><a href="/admin/findings/<%= f.id %>"><%= f.id %></a></td>
        <td><a href="/admin/scans/<%= f.scan_id %>"><%= f.scan_id %></a></td>
        <td><%= f.rule_id %></td>
        <td><%= f.severity %></td>
        <td class="truncate"><%= f.file_path %>:#<%= f.line %></td>
      </tr>
    <% end %>
    <% if @findings.empty? %><tr><td colspan="5" class="text-muted">No findings</td></tr><% end %>
  </tbody>
</table>
